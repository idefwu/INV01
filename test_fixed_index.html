<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>index.html ä¿®å¾©æ¸¬è©¦</title>
    <style>
        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .test-button {
            padding: 10px 20px;
            margin: 10px 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background: #007bff;
            color: white;
            font-size: 14px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid;
        }
        .success {
            background: #d4edda;
            border-color: #28a745;
            color: #155724;
        }
        .error {
            background: #f8d7da;
            border-color: #dc3545;
            color: #721c24;
        }
        .info {
            background: #d1ecf1;
            border-color: #17a2b8;
            color: #0c5460;
        }
        pre {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ”§ index.html ä¿®å¾©æ¸¬è©¦</h1>
        
        <h2>æ¸¬è©¦èªªæ˜</h2>
        <p>é€™å€‹é é¢å°‡æ¸¬è©¦ä¿®å¾©å¾Œçš„ index.html æ˜¯å¦èƒ½æ­£å¸¸é‹ä½œã€‚</p>
        
        <h3>æ¸¬è©¦æ­¥é©Ÿï¼š</h3>
        <ol>
            <li>é»æ“Šã€Œåœ¨æ–°è¦–çª—é–‹å•Ÿ index.htmlã€</li>
            <li>æŸ¥çœ‹ç€è¦½å™¨æ§åˆ¶å°æ˜¯å¦æœ‰éŒ¯èª¤è¨Šæ¯</li>
            <li>ç¢ºèªç³»çµ±åˆå§‹åŒ–æˆåŠŸæç¤º</li>
            <li>æ¸¬è©¦å•†å“ç®¡ç†é é¢çš„æŒ‰éˆ•æ˜¯å¦å¯é»æ“Š</li>
            <li>æ¸¬è©¦ROPç®¡ç†åŠŸèƒ½</li>
        </ol>
        
        <div>
            <button class="test-button" onclick="openIndexInNewWindow()">
                ğŸš€ åœ¨æ–°è¦–çª—é–‹å•Ÿ index.html
            </button>
            
            <button class="test-button" onclick="openWorkingSystem()">
                âœ… é–‹å•Ÿ working_system.html (åƒè€ƒç‰ˆæœ¬)
            </button>
            
            <button class="test-button" onclick="runQuickTest()">
                ğŸ§ª å¿«é€ŸåŠŸèƒ½æ¸¬è©¦
            </button>
        </div>
        
        <div id="test-results"></div>
        
        <h2>ä¿®å¾©å…§å®¹æ‘˜è¦</h2>
        <div class="result info">
            <h4>âœ… å·²ä¿®å¾©çš„å•é¡Œï¼š</h4>
            <ul>
                <li><strong>JavaScriptåˆå§‹åŒ–å¢å¼·</strong>ï¼šåŠ å…¥è©³ç´°çš„éŒ¯èª¤è™•ç†å’Œæ—¥èªŒ</li>
                <li><strong>å…¨åŸŸæ¨¡çµ„è¨ªå•</strong>ï¼šå°‡æ‰€æœ‰æ¨¡çµ„ç¶å®šåˆ° window ç‰©ä»¶ï¼Œç¢ºä¿æŒ‰éˆ•äº‹ä»¶å¯æ­£å¸¸è¨ªå•</li>
                <li><strong>æ¨¡çµ„åˆå§‹åŒ–å®¹éŒ¯</strong>ï¼šæ¯å€‹æ¨¡çµ„éƒ½æœ‰ç¨ç«‹çš„éŒ¯èª¤è™•ç†</li>
                <li><strong>å…¨åŸŸéŒ¯èª¤ç›£æ§</strong>ï¼šæ·»åŠ  window.onerror å’Œ unhandledrejection è™•ç†å™¨</li>
                <li><strong>è‡ªå‹•åŠŸèƒ½æ¸¬è©¦</strong>ï¼šç³»çµ±åˆå§‹åŒ–å¾Œè‡ªå‹•åŸ·è¡ŒåŸºæœ¬åŠŸèƒ½æ¸¬è©¦</li>
                <li><strong>ROPåŠŸèƒ½æ•´åˆ</strong>ï¼šç¢ºä¿ showSection å‡½æ•¸æ”¯æ´ ROP é é¢è¼‰å…¥</li>
            </ul>
        </div>
        
        <h2>æ¸¬è©¦æª¢æŸ¥é …ç›®</h2>
        <div id="checklist">
            <h4>è«‹åœ¨ä½¿ç”¨ index.html æ™‚ç¢ºèªä»¥ä¸‹é …ç›®ï¼š</h4>
            <ul>
                <li>âœ… é é¢è¼‰å…¥å¾Œé¡¯ç¤ºã€Œåº«å­˜ç®¡ç†ç³»çµ±åˆå§‹åŒ–æˆåŠŸï¼ã€ç¶ è‰²é€šçŸ¥</li>
                <li>âœ… ç€è¦½å™¨æ§åˆ¶å°é¡¯ç¤ºæ‰€æœ‰æ¨¡çµ„åˆå§‹åŒ–æˆåŠŸçš„æ—¥èªŒ</li>
                <li>âœ… é»æ“Šã€Œå•†å“ç®¡ç†ã€æ¨™ç±¤èƒ½æ­£å¸¸åˆ‡æ›é é¢</li>
                <li>âœ… å•†å“è¡¨æ ¼ä¸­çš„ç·¨è¼¯ã€æŸ¥çœ‹ã€èª¿æ•´ã€åˆªé™¤æŒ‰éˆ•éƒ½èƒ½æ­£å¸¸é»æ“Š</li>
                <li>âœ… é»æ“Šã€Œå†è¨‚è³¼é»ç®¡ç†ã€æ¨™ç±¤èƒ½é¡¯ç¤ºROPé é¢</li>
                <li>âœ… ROPé é¢èƒ½æ­£ç¢ºé¡¯ç¤ºéœ€è¦è£œè²¨çš„å•†å“ï¼ˆA002å’ŒB001ï¼‰</li>
                <li>âœ… å„ç¨®åŠŸèƒ½æŒ‰éˆ•é»æ“Šå¾Œéƒ½æœ‰ç›¸æ‡‰çš„æç¤ºè¨Šæ¯</li>
            </ul>
        </div>
        
        <h2>å¦‚æœä»æœ‰å•é¡Œ</h2>
        <div class="result error">
            <h4>é™¤éŒ¯æ­¥é©Ÿï¼š</h4>
            <ol>
                <li><strong>é–‹å•Ÿé–‹ç™¼è€…å·¥å…·</strong>ï¼šæŒ‰F12æˆ–å³éµã€Œæª¢æŸ¥ã€</li>
                <li><strong>æŸ¥çœ‹æ§åˆ¶å°</strong>ï¼šçœ‹æ˜¯å¦æœ‰ç´…è‰²éŒ¯èª¤è¨Šæ¯</li>
                <li><strong>æª¢æŸ¥ç¶²è·¯</strong>ï¼šç¢ºèªæ‰€æœ‰ .js æª”æ¡ˆéƒ½æœ‰æ­£ç¢ºè¼‰å…¥</li>
                <li><strong>å°æ¯”åƒè€ƒç‰ˆæœ¬</strong>ï¼šä½¿ç”¨ working_system.html å°æ¯”åŠŸèƒ½</li>
            </ol>
        </div>
    </div>
    
    <script>
        function openIndexInNewWindow() {
            const newWindow = window.open('index.html', '_blank', 'width=1200,height=800');
            
            // æ·»åŠ æ¸¬è©¦çµæœ
            addResult('success', 'å·²åœ¨æ–°è¦–çª—é–‹å•Ÿ index.htmlï¼Œè«‹æª¢æŸ¥åŠŸèƒ½æ˜¯å¦æ­£å¸¸');
            
            // çµ¦ä¸€äº›æŒ‡å¼•
            setTimeout(() => {
                addResult('info', 'è«‹æª¢æŸ¥æ–°è¦–çª—ä¸­çš„æ§åˆ¶å°è¨Šæ¯ï¼Œç¢ºèªæ‰€æœ‰æ¨¡çµ„éƒ½æˆåŠŸåˆå§‹åŒ–');
            }, 2000);
        }
        
        function openWorkingSystem() {
            window.open('working_system.html', '_blank', 'width=1200,height=800');
            addResult('info', 'å·²é–‹å•Ÿåƒè€ƒç‰ˆæœ¬ working_system.html ä¾›å°æ¯”');
        }
        
        function runQuickTest() {
            addResult('info', 'åŸ·è¡Œå¿«é€Ÿæ¸¬è©¦...');
            
            // æ¸¬è©¦åŸºæœ¬çš„JavaScriptåŠŸèƒ½
            try {
                // å‰µå»ºä¸€å€‹iframeä¾†æ¸¬è©¦index.html
                const iframe = document.createElement('iframe');
                iframe.src = 'index.html';
                iframe.style.display = 'none';
                document.body.appendChild(iframe);
                
                iframe.onload = function() {
                    try {
                        const iframeWindow = iframe.contentWindow;
                        
                        // ç­‰å¾…ä¸€ä¸‹è®“ç³»çµ±åˆå§‹åŒ–
                        setTimeout(() => {
                            try {
                                const inventorySystem = iframeWindow.inventorySystem;
                                if (inventorySystem) {
                                    addResult('success', 'âœ… InventorySystem å¯¦ä¾‹å¯ä»¥è¨ªå•');
                                    
                                    const productCount = inventorySystem.products.length;
                                    addResult('success', `âœ… è¼‰å…¥äº† ${productCount} å€‹å•†å“`);
                                    
                                    const reorderCount = inventorySystem.getReorderProducts().length;
                                    addResult('success', `âœ… æ‰¾åˆ° ${reorderCount} å€‹éœ€è¦è£œè²¨çš„å•†å“`);
                                    
                                    // æ¸¬è©¦æ¨¡çµ„æ˜¯å¦å¯è¨ªå•
                                    const productsModule = iframeWindow.productsModule;
                                    if (productsModule && typeof productsModule.editProduct === 'function') {
                                        addResult('success', 'âœ… productsModule æ¨¡çµ„å’Œæ–¹æ³•å¯ä»¥è¨ªå•');
                                    } else {
                                        addResult('error', 'âŒ productsModule æ¨¡çµ„ç„¡æ³•è¨ªå•');
                                    }
                                    
                                    const ropModule = iframeWindow.ropModule;
                                    if (ropModule && typeof ropModule.loadROPData === 'function') {
                                        addResult('success', 'âœ… ropModule æ¨¡çµ„å’Œæ–¹æ³•å¯ä»¥è¨ªå•');
                                    } else {
                                        addResult('error', 'âŒ ropModule æ¨¡çµ„ç„¡æ³•è¨ªå•');
                                    }
                                    
                                } else {
                                    addResult('error', 'âŒ InventorySystem å¯¦ä¾‹ç„¡æ³•è¨ªå•');
                                }
                            } catch (e) {
                                addResult('error', 'âŒ è¨ªå•iframeå…§å®¹æ™‚ç™¼ç”ŸéŒ¯èª¤: ' + e.message);
                            } finally {
                                // æ¸…ç†iframe
                                document.body.removeChild(iframe);
                            }
                        }, 2000);
                        
                    } catch (e) {
                        addResult('error', 'âŒ iframeæ¸¬è©¦å¤±æ•—: ' + e.message);
                        document.body.removeChild(iframe);
                    }
                };
                
                iframe.onerror = function() {
                    addResult('error', 'âŒ ç„¡æ³•è¼‰å…¥ index.html é€²è¡Œæ¸¬è©¦');
                    document.body.removeChild(iframe);
                };
                
            } catch (error) {
                addResult('error', 'âŒ å¿«é€Ÿæ¸¬è©¦å¤±æ•—: ' + error.message);
            }
        }
        
        function addResult(type, message) {
            const resultsDiv = document.getElementById('test-results');
            const result = document.createElement('div');
            result.className = `result ${type}`;
            result.innerHTML = `<strong>[${new Date().toLocaleTimeString()}]</strong> ${message}`;
            resultsDiv.appendChild(result);
            
            // æ»¾å‹•åˆ°æœ€æ–°çµæœ
            result.scrollIntoView({ behavior: 'smooth' });
        }
        
        // é é¢è¼‰å…¥æ™‚çš„èªªæ˜
        document.addEventListener('DOMContentLoaded', function() {
            addResult('info', 'æ¸¬è©¦ç’°å¢ƒå·²æº–å‚™å°±ç·’ï¼Œè«‹é–‹å§‹æ¸¬è©¦ä¿®å¾©å¾Œçš„ index.html');
        });
    </script>
</body>
</html>